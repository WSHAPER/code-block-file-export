/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var g=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var E=(r,i)=>{for(var n in i)g(r,n,{get:i[n],enumerable:!0})},C=(r,i,n,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let t of x(i))!f.call(r,t)&&t!==n&&g(r,t,{get:()=>i[t],enumerable:!(o=w(i,t))||o.enumerable});return r};var A=r=>C(g({},"__esModule",{value:!0}),r);var v={};E(v,{default:()=>d});module.exports=A(v);var a=require("obsidian"),y={defaultFileExtension:"txt",customLanguageMappings:"{}"},d=class extends a.Plugin{constructor(){super(...arguments);this.LANGUAGE_EXTENSIONS={js:"js",javascript:"js",jsx:"jsx",ts:"ts",typescript:"ts",tsx:"tsx",html:"html",xml:"xml",svg:"svg",css:"css",scss:"scss",sass:"sass",less:"less",json:"json",php:"php",py:"py",python:"py",rb:"rb",ruby:"rb",java:"java",c:"c",cpp:"cpp",cs:"cs",csharp:"cs",go:"go",rust:"rs",swift:"swift",kotlin:"kt",bash:"sh",shell:"sh",sh:"sh",zsh:"sh",powershell:"ps1",ps:"ps1",ps1:"ps1",bat:"bat",cmd:"bat",yaml:"yaml",yml:"yml",toml:"toml",ini:"ini",csv:"csv",sql:"sql",mysql:"sql",pgsql:"sql",postgresql:"sql",md:"md",markdown:"md",tex:"tex",latex:"tex",r:"r",matlab:"m",graphql:"graphql",gql:"graphql",dart:"dart",dockerfile:"dockerfile"}}async onload(){await this.loadSettings(),this.addSettingTab(new u(this.app,this)),this.registerMarkdownPostProcessor(n=>{n.querySelectorAll("pre > code").forEach(t=>{let e=t.parentElement;if(!e)return;let s=this.getLanguageFromCodeBlock(t),l=this.createExportButton(t,s);e.appendChild(l)})})}getLanguageFromCodeBlock(n){let o=Array.from(n.classList),t=this.settings.defaultFileExtension;for(let e of o)if(e.startsWith("language-")){let s=e.substring(9).toLowerCase(),l={};try{l=JSON.parse(this.settings.customLanguageMappings)}catch(c){console.error("Error parsing custom language mappings:",c)}l[s]?t=l[s]:this.LANGUAGE_EXTENSIONS[s]?t=this.LANGUAGE_EXTENSIONS[s]:t=s;break}return t}createExportButton(n,o){let t=document.createElement("button");t.setAttribute("aria-label","Export to file"),t.classList.add("code-block-export-button");let e=document.createElement("div");e.classList.add("code-block-export-icon");let s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("width","18"),s.setAttribute("height","18"),s.setAttribute("viewBox","0 0 24 24"),s.setAttribute("fill","none"),s.setAttribute("xmlns","http://www.w3.org/2000/svg");let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M4 18H20V20H4V18Z"),l.setAttribute("fill","currentColor"),s.appendChild(l);let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M12 4L12 15"),c.setAttribute("stroke","currentColor"),c.setAttribute("stroke-width","2"),c.setAttribute("stroke-linecap","round"),s.appendChild(c);let p=document.createElementNS("http://www.w3.org/2000/svg","path");return p.setAttribute("d","M8 10L12 15L16 10"),p.setAttribute("stroke","currentColor"),p.setAttribute("stroke-width","2"),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),s.appendChild(p),e.appendChild(s),t.appendChild(e),t.addEventListener("click",async h=>{h.preventDefault(),h.stopPropagation();let m=n.textContent||"",b=this.createSuggestedFilename(m,o);await this.exportCodeToFile(m,b)}),t}createSuggestedFilename(n,o){let t=n.trim().split(`
`)[0].trim(),e="";if(t.startsWith("function")||t.includes("function ")){let s=t.match(/function\s+([a-zA-Z0-9_]+)/);s&&s[1]&&(e=s[1])}else if(t.startsWith("class")||t.includes("class ")){let s=t.match(/class\s+([a-zA-Z0-9_]+)/);s&&s[1]&&(e=s[1])}return e||(e="code-block"),e=this.toKebabCase(e),`${e}.${o}`}toKebabCase(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase()}async exportCodeToFile(n,o){try{let t=new Blob([n],{type:"text/plain"}),e=document.createElement("a");e.href=URL.createObjectURL(t),e.download=o,document.body.appendChild(e),e.click(),document.body.removeChild(e),setTimeout(()=>{URL.revokeObjectURL(e.href)},100),new a.Notice(`Code exported as ${o}`)}catch(t){console.error("Failed to export code to file:",t),new a.Notice("Failed to export code to file: "+t.message)}}onunload(){}async loadSettings(){this.settings=Object.assign({},y,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},u=class extends a.PluginSettingTab{constructor(n,o){super(n,o);this.plugin=o}display(){let{containerEl:n}=this;n.empty(),n.createEl("h2",{text:"Code Block File Export Settings"}),new a.Setting(n).setName("Default File Extension").setDesc("Default file extension to use when language cannot be detected").addText(o=>o.setPlaceholder("txt").setValue(this.plugin.settings.defaultFileExtension).onChange(async t=>{this.plugin.settings.defaultFileExtension=t,await this.plugin.saveSettings()})),new a.Setting(n).setName("Custom Language Mappings").setDesc("Add custom mappings from language names to file extensions (JSON format)").addTextArea(o=>{o.setPlaceholder('{"language": "extension", "custom": "ext"}').setValue(this.plugin.settings.customLanguageMappings).onChange(async t=>{try{JSON.parse(t),this.plugin.settings.customLanguageMappings=t,await this.plugin.saveSettings(),o.inputEl.removeClass("is-invalid")}catch(e){o.inputEl.addClass("is-invalid")}}),o.inputEl.addClass("code-block-export-json-input"),o.inputEl.rows=6}),n.createEl("div",{cls:"setting-item-description code-block-export-info",text:"Code blocks will be exported using your browser's download functionality. Files will be saved to your default downloads location."})}};
